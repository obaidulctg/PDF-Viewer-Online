pdfjsLib.GlobalWorkerOptions.workerSrc="scriptpdf2.js";const upload=document.getElementById("upload"),container=document.getElementById("pdf-container"),prevBtn=document.getElementById("prev"),nextBtn=document.getElementById("next"),pageInfo=document.getElementById("page-info"),pageNumInput=document.getElementById("page-num"),jumpBtn=document.getElementById("jump"),zoomInBtn=document.getElementById("zoom-in"),zoomOutBtn=document.getElementById("zoom-out"),toggleTheme=document.getElementById("toggle-theme"),printBtn=document.getElementById("print"),downloadBtn=document.getElementById("download"),urlInput=document.getElementById("pdf-url"),loadUrlBtn=document.getElementById("load-url");let pdfDoc=null,totalPages=0,currentPage=1,scale=1.2,currentFile=null;const pageCanvases=[],setTheme=e=>{document.body.classList.toggle("dark","dark"===e),toggleTheme.textContent="dark"===e?"â˜€ Light Mode":"\uD83C\uDF19 Dark Mode",localStorage.setItem("theme",e)};function renderAllPages(){container.innerHTML="",pageCanvases.length=0;for(let e=1;e<=totalPages;e++)pdfDoc.getPage(e).then(t=>{let n=t.getViewport({scale:scale}),a=document.createElement("canvas");a.width=n.width,a.height=n.height;let l=a.getContext("2d");t.render({canvasContext:l,viewport:n}),container.appendChild(a),pageCanvases[e]=a})}function updateNav(){pageInfo.textContent=`Page ${currentPage} / ${totalPages}`,prevBtn.disabled=currentPage<=1,nextBtn.disabled=currentPage>=totalPages,pageNumInput.value=currentPage}function scrollToPage(e){if(e<1||e>totalPages)return;currentPage=e,updateNav();let t=pageCanvases[e];t&&t.scrollIntoView({behavior:"smooth",block:"start"})}function rerenderPages(){pdfDoc&&(renderAllPages(),setTimeout(()=>scrollToPage(currentPage),500))}function loadPDF(e){pdfjsLib.getDocument(e).promise.then(e=>{pdfDoc=e,totalPages=e.numPages,currentPage=1,updateNav(),renderAllPages()}).catch(e=>{alert("Error loading PDF: "+e.message)})}toggleTheme.addEventListener("click",()=>{let e=document.body.classList.contains("dark");setTheme(e?"light":"dark")}),setTheme(localStorage.getItem("theme")||"light"),upload.addEventListener("change",e=>{let t=e.target.files[0];if(!t||"application/pdf"!==t.type)return;currentFile=t;let n=new FileReader;n.onload=function(){loadPDF(new Uint8Array(this.result))},n.readAsArrayBuffer(t)}),loadUrlBtn.addEventListener("click",()=>{let e=urlInput.value.trim();e&&(currentFile=null,loadPDF(e))}),prevBtn.addEventListener("click",()=>scrollToPage(currentPage-1)),nextBtn.addEventListener("click",()=>scrollToPage(currentPage+1)),jumpBtn.addEventListener("click",()=>scrollToPage(parseInt(pageNumInput.value))),zoomInBtn.addEventListener("click",()=>{scale=Math.min(scale+.2,3),rerenderPages()}),zoomOutBtn.addEventListener("click",()=>{scale=Math.max(scale-.2,.4),rerenderPages()}),printBtn.addEventListener("click",()=>window.print()),downloadBtn.addEventListener("click",()=>{if(currentFile){let e=document.createElement("a");e.href=URL.createObjectURL(currentFile),e.download=currentFile.name||"download.pdf",e.click()}else alert("PDF must be uploaded to enable download.")});
